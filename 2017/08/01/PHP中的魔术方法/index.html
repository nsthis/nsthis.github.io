<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><meta name="keywords" content="hello  广华, 广华, yuehuaxw, "><title>PHP中的魔术方法 | Hello  广华</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/8.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = 'https://hm.baidu.com/hm.js?' + '9b7534d772981730a36e6d23548ffe6a';
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
  })();
  </script></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">PHP中的魔术方法</h1><a id="logo" href="/.">Hello  广华</a><p class="description">今天你是否还有事情未完成？</p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">PHP中的魔术方法</h1><div class="post-meta">Aug 1, 2017<span> | </span><span class="category"><a href="/categories/PHP/">PHP</a></span><script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> 阅读</span></span><span class="post-time"><span class="post-meta-item-text"> | </span><span class="post-meta-item-icon"><i class="fa fa-keyboard-o"></i><!-- span.post-meta-item-text= " 字数统计："--><span class="post-count"> 3,682</span><span class="post-meta-item-text"> 字</span></span></span><span class="post-time">  |  <span class="post-meta-item-icon"><i class="fa fa-hourglass-half"></i><!-- span.post-meta-item-text= " 阅读时长："--><span class="post-count"> 16</span><span class="post-meta-item-text"> 分钟</span></span></span></div><div class="post-content"><p>PHP中魔术方法一共有十六中魔术方法</p>
<a id="more"></a>
<h2 id="魔术方法列表"><a href="#魔术方法列表" class="headerlink" title="魔术方法列表"></a>魔术方法列表</h2><p>__construct()，类的构造函数</p>
<p>__destruct()，类的析构函数</p>
<p>__call()，在对象中调用一个不可访问方法时调用</p>
<p>__callStatic()，用静态方式中调用一个不可访问方法时调用</p>
<p>__get()，获得一个类的成员变量时调用</p>
<p>__set()，设置一个类的成员变量时调用</p>
<p>__isset()，当对不可访问属性调用isset()或empty()时调用</p>
<p>__unset()，当对不可访问属性调用unset()时被调用</p>
<p>__sleep()，执行serialize()时，先会调用这个函数</p>
<p>__wakeup()，执行unserialize()时，先会调用这个函数</p>
<p>__toString()，类被当成字符串时的回应方法</p>
<p>__invoke()，调用函数的方式调用一个对象时的回应方法</p>
<p>__set_state()，调用var_export()导出类时，此静态方法会被调用</p>
<p>__clone()，当对象复制完成时调用</p>
<p>__autoload()，尝试加载未定义的类</p>
<p>__debugInfo()，打印所需调试信息</p>
<h2 id="构造函数"><a href="#构造函数" class="headerlink" title="构造函数"></a>构造函数</h2><p>在同一个类中只能声明一个构造方法，原因是，PHP不支持构造函数重载。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Db</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">	<span class="keyword">public</span> $name;    </span><br><span class="line">    <span class="keyword">public</span> $age;    </span><br><span class="line">    <span class="keyword">public</span> $sex;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">    * 显示声明一个构造方法且带参数</span></span><br><span class="line"><span class="comment">    */</span>                                           </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($name=<span class="string">""</span>, $sex=<span class="string">"男"</span>, $age=<span class="number">22</span>)</span></span></span><br><span class="line"><span class="function">    </span>&#123;   </span><br><span class="line">      <span class="keyword">$this</span>-&gt;name = $name;</span><br><span class="line">      <span class="keyword">$this</span>-&gt;sex = $sex;</span><br><span class="line">      <span class="keyword">$this</span>-&gt;age = $age;</span><br><span class="line">    &#125;</span><br><span class="line">     </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * say 方法</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">say</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123; </span><br><span class="line">      <span class="keyword">echo</span> <span class="string">"我叫："</span> . <span class="keyword">$this</span>-&gt;name . <span class="string">"，性别："</span> . <span class="keyword">$this</span>-&gt;sex . <span class="string">"，年龄："</span> . <span class="keyword">$this</span>-&gt;age;</span><br><span class="line">    &#125;  </span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="析构函数"><a href="#析构函数" class="headerlink" title="析构函数"></a>析构函数</h2><p>析构方法允许在销毁一个类之前执行的一些操作或完成一些功能，比如说关闭文件、释放结果集等。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span>  <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">//方法体</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="call-在对象中调用一个不可访问方法时调用。"><a href="#call-在对象中调用一个不可访问方法时调用。" class="headerlink" title="__call(),在对象中调用一个不可访问方法时调用。"></a>__call(),在对象中调用一个不可访问方法时调用。</h2><p>为了避免当调用的方法不存在时产生错误，而意外的导致程序中止，可以使用 __call() 方法来避免。<br>该方法在调用的方法不存在时会自动调用，程序仍会继续执行下去。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php"><span class="class"><span class="keyword">class</span> <span class="title">Person</span></span></span></span><br><span class="line"><span class="php">&#123;               </span></span><br><span class="line"><span class="php">  <span class="function"><span class="keyword">function</span> <span class="title">say</span><span class="params">()</span></span></span></span><br><span class="line"><span class="php">  &#123; </span></span><br><span class="line"><span class="php">                </span></span><br><span class="line"><span class="php">      <span class="keyword">echo</span> <span class="string">"Hello, world!&lt;br&gt;"</span>; </span></span><br><span class="line"><span class="php">  &#125;   </span></span><br><span class="line"><span class="php">     </span></span><br><span class="line">  /**</span><br><span class="line">   * 声明此方法用来处理调用对象中不存在的方法</span><br><span class="line"><span class="php">   */</span></span><br><span class="line"><span class="php">  <span class="function"><span class="keyword">function</span> <span class="title">__call</span><span class="params">($funName, $arguments)</span></span></span></span><br><span class="line"><span class="php">  &#123; </span></span><br><span class="line"><span class="php">     <span class="keyword">echo</span> <span class="string">"你所调用的函数："</span> . $funName . <span class="string">"(参数："</span> ; <span class="comment">// 输出调用不存在的方法名</span></span></span><br><span class="line"><span class="php">     print_r($arguments); <span class="comment">// 输出调用不存在的方法时的参数列表</span></span></span><br><span class="line"><span class="php">     <span class="keyword">echo</span> <span class="string">")不存在！&lt;br&gt;\n"</span>; <span class="comment">// 结束换行           </span></span></span><br><span class="line"><span class="php">  &#125;                     </span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php">$Person = <span class="keyword">new</span> Person();      </span></span><br><span class="line"><span class="php">$Person-&gt;run(<span class="string">"teacher"</span>); <span class="comment">// 调用对象中不存在的方法，则自动调用了对象中的__call()方法</span></span></span><br><span class="line"><span class="php">$Person-&gt;eat(<span class="string">"小明"</span>, <span class="string">"苹果"</span>);       </span></span><br><span class="line"><span class="php">$Person-&gt;say();</span></span><br></pre></td></tr></table></figure>
<p>运行结果:</p>
<p>调用的函数：run(参数：Array ( [0] =&gt; teacher ) )不存在！</p>
<p>调用的函数：eat(参数：Array ( [0] =&gt; 小明 [1] =&gt; 苹果 ) )不存在！</p>
<p>Hello, world!</p>
<h2 id="callStatic-用静态方式中调用一个不可访问方法时调用"><a href="#callStatic-用静态方式中调用一个不可访问方法时调用" class="headerlink" title="__callStatic(),用静态方式中调用一个不可访问方法时调用"></a>__callStatic(),用静态方式中调用一个不可访问方法时调用</h2><p>此方法与上面所说的 <strong>call() 功能除了 </strong>callStatic() 是未静态方法准备的之外，其它都是一样的</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php"><span class="class"><span class="keyword">class</span> <span class="title">Person</span></span></span></span><br><span class="line"><span class="php">&#123;</span></span><br><span class="line"><span class="php">  <span class="function"><span class="keyword">function</span> <span class="title">say</span><span class="params">()</span></span></span></span><br><span class="line"><span class="php">  &#123;</span></span><br><span class="line"><span class="php"> </span></span><br><span class="line"><span class="php">    <span class="keyword">echo</span> <span class="string">"Hello, world!&lt;br&gt;"</span>;</span></span><br><span class="line"><span class="php">  &#125;</span></span><br><span class="line"><span class="php"> </span></span><br><span class="line">  /**</span><br><span class="line">   * 声明此方法用来处理调用对象中不存在的方法</span><br><span class="line"><span class="php">   */</span></span><br><span class="line"><span class="php">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">__callStatic</span><span class="params">($funName, $arguments)</span></span></span></span><br><span class="line"><span class="php">  &#123;</span></span><br><span class="line"><span class="php">    <span class="keyword">echo</span> <span class="string">"你所调用的静态方法："</span> . $funName . <span class="string">"(参数："</span> ; <span class="comment">// 输出调用不存在的方法名</span></span></span><br><span class="line"><span class="php">    print_r($arguments); <span class="comment">// 输出调用不存在的方法时的参数列表</span></span></span><br><span class="line"><span class="php">    <span class="keyword">echo</span> <span class="string">")不存在！&lt;br&gt;\n"</span>; <span class="comment">// 结束换行</span></span></span><br><span class="line"><span class="php">  &#125;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php">$Person = <span class="keyword">new</span> Person();</span></span><br><span class="line"><span class="php">$Person::run(<span class="string">"teacher"</span>); <span class="comment">// 调用对象中不存在的方法，则自动调用了对象中的__call()方法</span></span></span><br><span class="line"><span class="php">$Person::eat(<span class="string">"小明"</span>, <span class="string">"苹果"</span>);</span></span><br><span class="line"><span class="php">$Person-&gt;say();</span></span><br></pre></td></tr></table></figure>
<p>运行结果如下：</p>
<p>调用的静态方法：run(参数：Array ( [0] =&gt; teacher ) )不存在！</p>
<p>调用的静态方法：eat(参数：Array ( [0] =&gt; 小明 [1] =&gt; 苹果 ) )不存在！</p>
<p>Hello, world!</p>
<h2 id="get-获得一个类的成员变量时调用"><a href="#get-获得一个类的成员变量时调用" class="headerlink" title="__get(),获得一个类的成员变量时调用"></a>__get(),获得一个类的成员变量时调用</h2><p>在 php 面向对象编程中，类的成员属性被设定为 private 后，如果我们试图在外面调用它则会出现“不能访问某个私有属性”的错误。那么为了解决这个问题，我们可以使用魔术方法 __get()。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php"><span class="class"><span class="keyword">class</span> <span class="title">Person</span></span></span></span><br><span class="line"><span class="php">&#123;</span></span><br><span class="line"><span class="php">  <span class="keyword">private</span> $name;</span></span><br><span class="line"><span class="php">  <span class="keyword">private</span> $age;</span></span><br><span class="line"><span class="php"> </span></span><br><span class="line"><span class="php">  <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($name=<span class="string">""</span>, $age=<span class="number">1</span>)</span></span></span></span><br><span class="line"><span class="php">  &#123;</span></span><br><span class="line"><span class="php">    <span class="keyword">$this</span>-&gt;name = $name;</span></span><br><span class="line"><span class="php">    <span class="keyword">$this</span>-&gt;age = $age;</span></span><br><span class="line"><span class="php">  &#125;</span></span><br><span class="line"><span class="php"> </span></span><br><span class="line">  /**</span><br><span class="line">   * 在类中添加__get()方法，在直接获取属性值时自动调用一次，以属性名作为参数传入并处理</span><br><span class="line">   * @param $propertyName</span><br><span class="line">   *</span><br><span class="line">   * @return int</span><br><span class="line"><span class="php">   */</span></span><br><span class="line"><span class="php">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span><span class="params">($propertyName)</span></span></span></span><br><span class="line"><span class="php">  &#123;  </span></span><br><span class="line"><span class="php">    <span class="keyword">if</span> ($propertyName == <span class="string">"age"</span>) &#123;</span></span><br><span class="line"><span class="php">      <span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;age &gt; <span class="number">30</span>) &#123;</span></span><br><span class="line"><span class="php">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;age - <span class="number">10</span>;</span></span><br><span class="line"><span class="php">      &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="php">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;$propertyName;</span></span><br><span class="line"><span class="php">      &#125;</span></span><br><span class="line"><span class="php">    &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="php">      <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;$propertyName;</span></span><br><span class="line"><span class="php">    &#125;</span></span><br><span class="line"><span class="php">  &#125;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php">$Person = <span class="keyword">new</span> Person(<span class="string">"小明"</span>, <span class="number">60</span>);  <span class="comment">// 通过Person类实例化的对象，并通过构造方法为属性赋初值</span></span></span><br><span class="line"><span class="php"><span class="keyword">echo</span> <span class="string">"姓名："</span> . $Person-&gt;name . <span class="string">"&lt;br&gt;"</span>;  <span class="comment">// 直接访问私有属性name，自动调用了__get()方法可以间接获取</span></span></span><br><span class="line"><span class="php"><span class="keyword">echo</span> <span class="string">"年龄："</span> . $Person-&gt;age . <span class="string">"&lt;br&gt;"</span>;  <span class="comment">// 自动调用了__get()方法，根据对象本身的情况会返回不同的值</span></span></span><br></pre></td></tr></table></figure>
<p>运行结果：</p>
<p>姓名：小明</p>
<p>年龄：50</p>
<h2 id="set-，设置一个类的成员变量时调用"><a href="#set-，设置一个类的成员变量时调用" class="headerlink" title="__set()，设置一个类的成员变量时调用"></a>__set()，设置一个类的成员变量时调用</h2><p>用来设置私有属性， 给一个未定义的属性赋值时，此方法会被触发，传递的参数是被设置的属性名和值。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php"><span class="class"><span class="keyword">class</span> <span class="title">Person</span></span></span></span><br><span class="line"><span class="php">&#123;</span></span><br><span class="line"><span class="php">  <span class="keyword">private</span> $name;</span></span><br><span class="line"><span class="php">  <span class="keyword">private</span> $age;</span></span><br><span class="line"><span class="php"> </span></span><br><span class="line"><span class="php">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($name=<span class="string">""</span>, $age=<span class="number">25</span>)</span></span></span></span><br><span class="line"><span class="php">  &#123;</span></span><br><span class="line"><span class="php">    <span class="keyword">$this</span>-&gt;name = $name;</span></span><br><span class="line"><span class="php">    <span class="keyword">$this</span>-&gt;age = $age;</span></span><br><span class="line"><span class="php">  &#125;</span></span><br><span class="line"><span class="php"> </span></span><br><span class="line">  /**</span><br><span class="line">   * 声明魔术方法需要两个参数，真接为私有属性赋值时自动调用，并可以屏蔽一些非法赋值</span><br><span class="line">   * @param $property</span><br><span class="line">   * @param $value</span><br><span class="line"><span class="php">   */</span></span><br><span class="line"><span class="php">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__set</span><span class="params">($property, $value)</span> </span>&#123;</span></span><br><span class="line"><span class="php">    <span class="keyword">if</span> ($property==<span class="string">"age"</span>)</span></span><br><span class="line"><span class="php">    &#123;</span></span><br><span class="line"><span class="php">      <span class="keyword">if</span> ($value &gt; <span class="number">150</span> || $value &lt; <span class="number">0</span>) &#123;</span></span><br><span class="line"><span class="php">        <span class="keyword">return</span>;</span></span><br><span class="line"><span class="php">      &#125;</span></span><br><span class="line"><span class="php">    &#125;</span></span><br><span class="line"><span class="php">    <span class="keyword">$this</span>-&gt;$property = $value;</span></span><br><span class="line"><span class="php">  &#125;</span></span><br><span class="line"><span class="php"> </span></span><br><span class="line">  /**</span><br><span class="line">   * 在类中声明说话的方法，将所有的私有属性说出</span><br><span class="line"><span class="php">   */</span></span><br><span class="line"><span class="php">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">say</span><span class="params">()</span></span>&#123;</span></span><br><span class="line"><span class="php">    <span class="keyword">echo</span> <span class="string">"我叫"</span>.<span class="keyword">$this</span>-&gt;name.<span class="string">"，今年"</span>.<span class="keyword">$this</span>-&gt;age.<span class="string">"岁了"</span>;</span></span><br><span class="line"><span class="php">  &#125;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"> </span></span><br><span class="line"><span class="php">$Person=<span class="keyword">new</span> Person(<span class="string">"小明"</span>, <span class="number">25</span>); <span class="comment">//注意，初始值将被下面所改变</span></span></span><br><span class="line"><span class="php"><span class="comment">//自动调用了__set()函数，将属性名name传给第一个参数，将属性值”李四”传给第二个参数</span></span></span><br><span class="line"><span class="php">$Person-&gt;name = <span class="string">"小红"</span>;   <span class="comment">//赋值成功。如果没有__set()，则出错。</span></span></span><br><span class="line"><span class="php"><span class="comment">//自动调用了__set()函数，将属性名age传给第一个参数，将属性值26传给第二个参数</span></span></span><br><span class="line"><span class="php">$Person-&gt;age = <span class="number">16</span>; <span class="comment">//赋值成功</span></span></span><br><span class="line"><span class="php">$Person-&gt;age = <span class="number">160</span>; <span class="comment">//160是一个非法值，赋值失效</span></span></span><br><span class="line"><span class="php">$Person-&gt;say(); <span class="comment">//输出：我叫小红，今年16岁了</span></span></span><br></pre></td></tr></table></figure>
<p>运行结果：</p>
<p>我叫小红，今年16岁了</p>
<h2 id="isset-当对不可访问属性调用isset-或empty-时调用"><a href="#isset-当对不可访问属性调用isset-或empty-时调用" class="headerlink" title="__isset(),当对不可访问属性调用isset()或empty()时调用"></a>__isset(),当对不可访问属性调用isset()或empty()时调用</h2><p>当对不可访问属性调用 isset() 或 empty() 时，__isset() 会被调用。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php"><span class="class"><span class="keyword">class</span> <span class="title">Person</span></span></span></span><br><span class="line"><span class="php">&#123;</span></span><br><span class="line"><span class="php">  <span class="keyword">public</span> $sex;</span></span><br><span class="line"><span class="php">  <span class="keyword">private</span> $name;</span></span><br><span class="line"><span class="php">  <span class="keyword">private</span> $age;</span></span><br><span class="line"><span class="php"> </span></span><br><span class="line"><span class="php">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($name=<span class="string">""</span>, $age=<span class="number">25</span>, $sex=<span class="string">'男'</span>)</span></span></span></span><br><span class="line"><span class="php">  &#123;</span></span><br><span class="line"><span class="php">    <span class="keyword">$this</span>-&gt;name = $name;</span></span><br><span class="line"><span class="php">    <span class="keyword">$this</span>-&gt;age = $age;</span></span><br><span class="line"><span class="php">    <span class="keyword">$this</span>-&gt;sex = $sex;</span></span><br><span class="line"><span class="php">  &#125;</span></span><br><span class="line"><span class="php"> </span></span><br><span class="line">  /**</span><br><span class="line">   * @param $content</span><br><span class="line">   *</span><br><span class="line">   * @return bool</span><br><span class="line"><span class="php">   */</span></span><br><span class="line"><span class="php">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__isset</span><span class="params">($content)</span> </span>&#123;</span></span><br><span class="line"><span class="php">    <span class="keyword">echo</span> <span class="string">"当在类外部使用isset()函数测定私有成员&#123;$content&#125;时，自动调用&lt;br&gt;"</span>;</span></span><br><span class="line"><span class="php">    <span class="keyword">echo</span> <span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;$content);</span></span><br><span class="line"><span class="php">  &#125;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"> </span></span><br><span class="line"><span class="php">$person = <span class="keyword">new</span> Person(<span class="string">"小明"</span>, <span class="number">25</span>); <span class="comment">// 初始赋值</span></span></span><br><span class="line"><span class="php"><span class="keyword">echo</span> <span class="keyword">isset</span>($person-&gt;sex),<span class="string">"&lt;br&gt;"</span>;</span></span><br><span class="line"><span class="php"><span class="keyword">echo</span> <span class="keyword">isset</span>($person-&gt;name),<span class="string">"&lt;br&gt;"</span>;</span></span><br><span class="line"><span class="php"><span class="keyword">echo</span> <span class="keyword">isset</span>($person-&gt;age),<span class="string">"&lt;br&gt;"</span>;</span></span><br></pre></td></tr></table></figure>
<p>运行结果如下：</p>
<p>当在类外部使用isset()函数测定私有成员name时，自动调用 // __isset() 内 第一个echo</p>
<p>当在类外部使用isset()函数测定私有成员age时，自动调用 // __isset() 内 第一个echo</p>
<h2 id="unset-当对不可访问属性调用unset-时被调用。"><a href="#unset-当对不可访问属性调用unset-时被调用。" class="headerlink" title="__unset(),当对不可访问属性调用unset()时被调用。"></a>__unset(),当对不可访问属性调用unset()时被调用。</h2><p>1、如果一个对象里面的成员属性是公有的，就可以使用这个函数在对象外面删除对象的公有属性。</p>
<p>2、如果对象的成员属性是私有的，我使用这个函数就没有权限去删除。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php"><span class="class"><span class="keyword">class</span> <span class="title">Person</span></span></span></span><br><span class="line"><span class="php">&#123;</span></span><br><span class="line"><span class="php">  <span class="keyword">public</span> $sex;</span></span><br><span class="line"><span class="php">  <span class="keyword">private</span> $name;</span></span><br><span class="line"><span class="php">  <span class="keyword">private</span> $age;</span></span><br><span class="line"><span class="php"> </span></span><br><span class="line"><span class="php">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($name=<span class="string">""</span>, $age=<span class="number">25</span>, $sex=<span class="string">'男'</span>)</span></span></span></span><br><span class="line"><span class="php">  &#123;</span></span><br><span class="line"><span class="php">    <span class="keyword">$this</span>-&gt;name = $name;</span></span><br><span class="line"><span class="php">    <span class="keyword">$this</span>-&gt;age = $age;</span></span><br><span class="line"><span class="php">    <span class="keyword">$this</span>-&gt;sex = $sex;</span></span><br><span class="line"><span class="php">  &#125;</span></span><br><span class="line"><span class="php"> </span></span><br><span class="line">  /**</span><br><span class="line">   * @param $content</span><br><span class="line">   *</span><br><span class="line">   * @return bool</span><br><span class="line"><span class="php">   */</span></span><br><span class="line"><span class="php">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__unset</span><span class="params">($content)</span> </span>&#123;</span></span><br><span class="line"><span class="php">    <span class="keyword">echo</span> <span class="string">"当在类外部使用unset()函数来删除私有成员时自动调用的&lt;br&gt;"</span>;</span></span><br><span class="line"><span class="php">    <span class="keyword">echo</span> <span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;$content);</span></span><br><span class="line"><span class="php">  &#125;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"> </span></span><br><span class="line"><span class="php">$person = <span class="keyword">new</span> Person(<span class="string">"小明"</span>, <span class="number">25</span>); <span class="comment">// 初始赋值</span></span></span><br><span class="line"><span class="php"><span class="keyword">unset</span>($person-&gt;sex);</span></span><br><span class="line"><span class="php"><span class="keyword">unset</span>($person-&gt;name);</span></span><br><span class="line"><span class="php"><span class="keyword">unset</span>($person-&gt;age);</span></span><br></pre></td></tr></table></figure>
<p>运行结果：</p>
<p>当在类外部使用unset()函数来删除私有成员时自动调用的</p>
<h2 id="sleep-，执行serialize-时，先会调用这个函数"><a href="#sleep-，执行serialize-时，先会调用这个函数" class="headerlink" title="__sleep()，执行serialize()时，先会调用这个函数"></a>__sleep()，执行serialize()时，先会调用这个函数</h2><p>erialize() 函数会检查类中是否存在一个魔术方法 __sleep()。如果存在，则该方法会优先被调用，然后才执行序列化操作。</p>
<p>此功能可以用于清理对象，并返回一个包含对象中所有应被序列化的变量名称的数组。</p>
<p>如果该方法未返回任何内容，则 NULL 被序列化，并产生一个 E_NOTICE 级别的错误。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php"><span class="class"><span class="keyword">class</span> <span class="title">Person</span></span></span></span><br><span class="line"><span class="php">&#123;</span></span><br><span class="line"><span class="php">  <span class="keyword">public</span> $sex;</span></span><br><span class="line"><span class="php">  <span class="keyword">public</span> $name;</span></span><br><span class="line"><span class="php">  <span class="keyword">public</span> $age;</span></span><br><span class="line"><span class="php"> </span></span><br><span class="line"><span class="php">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($name=<span class="string">""</span>, $age=<span class="number">25</span>, $sex=<span class="string">'男'</span>)</span></span></span></span><br><span class="line"><span class="php">  &#123;</span></span><br><span class="line"><span class="php">    <span class="keyword">$this</span>-&gt;name = $name;</span></span><br><span class="line"><span class="php">    <span class="keyword">$this</span>-&gt;age = $age;</span></span><br><span class="line"><span class="php">    <span class="keyword">$this</span>-&gt;sex = $sex;</span></span><br><span class="line"><span class="php">  &#125;</span></span><br><span class="line"><span class="php"> </span></span><br><span class="line">  /**</span><br><span class="line">   * @return array</span><br><span class="line"><span class="php">   */</span></span><br><span class="line"><span class="php">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__sleep</span><span class="params">()</span> </span>&#123;</span></span><br><span class="line"><span class="php">    <span class="keyword">echo</span> <span class="string">"当在类外部使用serialize()时会调用这里的__sleep()方法&lt;br&gt;"</span>;</span></span><br><span class="line"><span class="php">    <span class="keyword">$this</span>-&gt;name = base64_encode(<span class="keyword">$this</span>-&gt;name);</span></span><br><span class="line"><span class="php">    <span class="keyword">return</span> <span class="keyword">array</span>(<span class="string">'name'</span>, <span class="string">'age'</span>); <span class="comment">// 这里必须返回一个数值，里边的元素表示返回的属性名称</span></span></span><br><span class="line"><span class="php">  &#125;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"> </span></span><br><span class="line"><span class="php">$person = <span class="keyword">new</span> Person(<span class="string">'小明'</span>); <span class="comment">// 初始赋值</span></span></span><br><span class="line"><span class="php"><span class="keyword">echo</span> serialize($person);</span></span><br><span class="line"><span class="php"><span class="keyword">echo</span> <span class="string">'&lt;br/&gt;'</span>;</span></span><br></pre></td></tr></table></figure>
<p>代码运行结果：</p>
<p>当在类外部使用serialize()时会调用这里的__sleep()方法</p>
<p>O:6:”Person”:2:{s:4:”name”;s:8:”5bCP5piO”;s:3:”age”;i:25;}</p>
<p>注：<br>__sleep() 不能返回父类的私有成员的名字。这样做会产生一个 E_NOTICE 级别的错误。可以用 Serializable 接口来替代。</p>
<p>__sleep() 方法常用于提交未提交的数据，或类似的清理操作。同时，如果有一些很大的对象，但不需要全部保存，这个功能就很好用。</p>
<h2 id="wakeup-执行unserialize-时，先会调用这个函数"><a href="#wakeup-执行unserialize-时，先会调用这个函数" class="headerlink" title="__wakeup(),执行unserialize()时，先会调用这个函数"></a>__wakeup(),执行unserialize()时，先会调用这个函数</h2><p>unserialize() 会检查是否存在一个 <strong>wakeup()方法。如果存在，则会先调用 </strong>wakeup方法，预先准备对象需要的资源。</p>
<p>__wakeup() 经常用在反序列化操作中，例如重新建立数据库连接，或执行其它初始化操作。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php"><span class="class"><span class="keyword">class</span> <span class="title">Person</span></span></span></span><br><span class="line"><span class="php">&#123;</span></span><br><span class="line"><span class="php">  <span class="keyword">public</span> $sex;</span></span><br><span class="line"><span class="php">  <span class="keyword">public</span> $name;</span></span><br><span class="line"><span class="php">  <span class="keyword">public</span> $age;</span></span><br><span class="line"><span class="php"> </span></span><br><span class="line"><span class="php">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($name=<span class="string">""</span>, $age=<span class="number">25</span>, $sex=<span class="string">'男'</span>)</span></span></span></span><br><span class="line"><span class="php">  &#123;</span></span><br><span class="line"><span class="php">    <span class="keyword">$this</span>-&gt;name = $name;</span></span><br><span class="line"><span class="php">    <span class="keyword">$this</span>-&gt;age = $age;</span></span><br><span class="line"><span class="php">    <span class="keyword">$this</span>-&gt;sex = $sex;</span></span><br><span class="line"><span class="php">  &#125;</span></span><br><span class="line"><span class="php"> </span></span><br><span class="line">  /**</span><br><span class="line">   * @return array</span><br><span class="line"><span class="php">   */</span></span><br><span class="line"><span class="php">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__sleep</span><span class="params">()</span> </span>&#123;</span></span><br><span class="line"><span class="php">    <span class="keyword">echo</span> <span class="string">"当在类外部使用serialize()时会调用这里的__sleep()方法&lt;br&gt;"</span>;</span></span><br><span class="line"><span class="php">    <span class="keyword">$this</span>-&gt;name = base64_encode(<span class="keyword">$this</span>-&gt;name);</span></span><br><span class="line"><span class="php">    <span class="keyword">return</span> <span class="keyword">array</span>(<span class="string">'name'</span>, <span class="string">'age'</span>); <span class="comment">// 这里必须返回一个数值，里边的元素表示返回的属性名称</span></span></span><br><span class="line"><span class="php">  &#125;</span></span><br><span class="line"><span class="php"> </span></span><br><span class="line">  /**</span><br><span class="line">   * __wakeup</span><br><span class="line"><span class="php">   */</span></span><br><span class="line"><span class="php">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span><span class="params">()</span> </span>&#123;</span></span><br><span class="line"><span class="php">    <span class="keyword">echo</span> <span class="string">"当在类外部使用unserialize()时会调用这里的__wakeup()方法&lt;br&gt;"</span>;</span></span><br><span class="line"><span class="php">    <span class="keyword">$this</span>-&gt;name = <span class="number">2</span>;</span></span><br><span class="line"><span class="php">    <span class="keyword">$this</span>-&gt;sex = <span class="string">'男'</span>;</span></span><br><span class="line"><span class="php">    <span class="comment">// 这里不需要返回数组</span></span></span><br><span class="line"><span class="php">  &#125;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"> </span></span><br><span class="line"><span class="php">$person = <span class="keyword">new</span> Person(<span class="string">'小明'</span>); <span class="comment">// 初始赋值</span></span></span><br><span class="line"><span class="php">var_dump(serialize($person));</span></span><br><span class="line"><span class="php">var_dump(unserialize(serialize($person)));</span></span><br></pre></td></tr></table></figure>
<p>运行结果：</p>
<p>当在类外部使用serialize()时会调用这里的__sleep()方法</p>
<p>string(58) “O:6:”Person”:2:{s:4:”name”;s:8:”5bCP5piO”;s:3:”age”;i:25;}” 当在类外部使用serialize()时会调用这里的__sleep()方法</p>
<p>当在类外部使用unserialize()时会调用这里的__wakeup()方法</p>
<p>object(Person)#2 (3) { [“sex”]=&gt; string(3) “男” [“name”]=&gt; int(2) [“age”]=&gt; int(25) }</p>
<h2 id="toString-，类被当成字符串时的回应方法"><a href="#toString-，类被当成字符串时的回应方法" class="headerlink" title="__toString()，类被当成字符串时的回应方法"></a>__toString()，类被当成字符串时的回应方法</h2><p>__toString() 方法用于一个类被当成字符串时应怎样回应。例如 <code>echo $obj;</code> 应该显示些什么。</p>
<p>此方法必须返回一个字符串，否则将发出一条 <code>E_RECOVERABLE_ERROR</code> 级别的致命错误。</p>
<p>不能在 __toString() 方法中抛出异常。这么做会导致致命错误。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php"><span class="class"><span class="keyword">class</span> <span class="title">Person</span></span></span></span><br><span class="line"><span class="php">&#123;</span></span><br><span class="line"><span class="php">  <span class="keyword">public</span> $sex;</span></span><br><span class="line"><span class="php">  <span class="keyword">public</span> $name;</span></span><br><span class="line"><span class="php">  <span class="keyword">public</span> $age;</span></span><br><span class="line"><span class="php"> </span></span><br><span class="line"><span class="php">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($name=<span class="string">""</span>, $age=<span class="number">25</span>, $sex=<span class="string">'男'</span>)</span></span></span></span><br><span class="line"><span class="php">  &#123;</span></span><br><span class="line"><span class="php">    <span class="keyword">$this</span>-&gt;name = $name;</span></span><br><span class="line"><span class="php">    <span class="keyword">$this</span>-&gt;age = $age;</span></span><br><span class="line"><span class="php">    <span class="keyword">$this</span>-&gt;sex = $sex;</span></span><br><span class="line"><span class="php">  &#125;</span></span><br><span class="line"><span class="php"> </span></span><br><span class="line"><span class="php">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span><span class="params">()</span></span></span></span><br><span class="line"><span class="php">  &#123;</span></span><br><span class="line"><span class="php">    <span class="keyword">return</span> <span class="string">'go go go'</span>;</span></span><br><span class="line"><span class="php">  &#125;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"> </span></span><br><span class="line"><span class="php">$person = <span class="keyword">new</span> Person(<span class="string">'小明'</span>); <span class="comment">// 初始赋值</span></span></span><br><span class="line"><span class="php"><span class="keyword">echo</span> $person;</span></span><br></pre></td></tr></table></figure>
<p>结果：</p>
<p>go go go</p>
<h2 id="invoke-，调用函数的方式调用一个对象时的回应方法"><a href="#invoke-，调用函数的方式调用一个对象时的回应方法" class="headerlink" title="__invoke()，调用函数的方式调用一个对象时的回应方法"></a>__invoke()，调用函数的方式调用一个对象时的回应方法</h2><p>当尝试以调用函数的方式调用一个对象时，__invoke() 方法会被自动调用。</p>
<p>注意：本特性只在 PHP 5.3.0 及以上版本有效。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php"><span class="class"><span class="keyword">class</span> <span class="title">Person</span></span></span></span><br><span class="line"><span class="php">&#123;</span></span><br><span class="line"><span class="php">  <span class="keyword">public</span> $sex;</span></span><br><span class="line"><span class="php">  <span class="keyword">public</span> $name;</span></span><br><span class="line"><span class="php">  <span class="keyword">public</span> $age;</span></span><br><span class="line"><span class="php"> </span></span><br><span class="line"><span class="php">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($name=<span class="string">""</span>, $age=<span class="number">25</span>, $sex=<span class="string">'男'</span>)</span></span></span></span><br><span class="line"><span class="php">  &#123;</span></span><br><span class="line"><span class="php">    <span class="keyword">$this</span>-&gt;name = $name;</span></span><br><span class="line"><span class="php">    <span class="keyword">$this</span>-&gt;age = $age;</span></span><br><span class="line"><span class="php">    <span class="keyword">$this</span>-&gt;sex = $sex;</span></span><br><span class="line"><span class="php">  &#125;</span></span><br><span class="line"><span class="php"> </span></span><br><span class="line"><span class="php">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span><span class="params">()</span> </span>&#123;</span></span><br><span class="line"><span class="php">    <span class="keyword">echo</span> <span class="string">'这可是一个对象哦'</span>;</span></span><br><span class="line"><span class="php">  &#125;</span></span><br><span class="line"><span class="php"> </span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"> </span></span><br><span class="line"><span class="php">$person = <span class="keyword">new</span> Person(<span class="string">'小明'</span>); <span class="comment">// 初始赋值</span></span></span><br><span class="line"><span class="php">$person();</span></span><br></pre></td></tr></table></figure>
<p>查看运行结果：</p>
<p>这可是一个对象哦</p>
<p>当然，如果你执意要将对象当函数方法使用，那么会得到下面结果：</p>
<p>Fatal error: index.php on line 18</p>
<h2 id="set-state-，调用var-export-导出类时，此静态方法会被调用。"><a href="#set-state-，调用var-export-导出类时，此静态方法会被调用。" class="headerlink" title="__set_state()，调用var_export()导出类时，此静态方法会被调用。"></a>__set_state()，调用var_export()导出类时，此静态方法会被调用。</h2><p>自 PHP 5.1.0 起，当调用 var_export() 导出类时，此静态方法会被自动调用。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php">	<span class="class"><span class="keyword">class</span> <span class="title">Person</span></span></span></span><br><span class="line"><span class="php">	&#123;</span></span><br><span class="line"><span class="php">	  <span class="keyword">public</span> $sex;</span></span><br><span class="line"><span class="php">	  <span class="keyword">public</span> $name;</span></span><br><span class="line"><span class="php">	  <span class="keyword">public</span> $age;</span></span><br><span class="line"><span class="php">	 </span></span><br><span class="line"><span class="php">	  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($name=<span class="string">""</span>, $age=<span class="number">25</span>, $sex=<span class="string">'男'</span>)</span></span></span></span><br><span class="line"><span class="php">	  &#123;</span></span><br><span class="line"><span class="php">	    <span class="keyword">$this</span>-&gt;name = $name;</span></span><br><span class="line"><span class="php">	    <span class="keyword">$this</span>-&gt;age = $age;</span></span><br><span class="line"><span class="php">	    <span class="keyword">$this</span>-&gt;sex = $sex;</span></span><br><span class="line"><span class="php">	  &#125;</span></span><br><span class="line"><span class="php">	 </span></span><br><span class="line"><span class="php">	&#125;</span></span><br><span class="line"><span class="php">	 </span></span><br><span class="line"><span class="php">	$person = <span class="keyword">new</span> Person(<span class="string">'小明'</span>); <span class="comment">// 初始赋值</span></span></span><br><span class="line"><span class="php">	var_export($person);</span></span><br></pre></td></tr></table></figure>
<p>看结果：</p>
<p>Person::__set_state(array( ‘sex’ =&gt; ‘男’, ‘name’ =&gt; ‘小明’, ‘age’ =&gt; 25, ))</p>
<h2 id="clone-，当对象复制完成时调用"><a href="#clone-，当对象复制完成时调用" class="headerlink" title="__clone()，当对象复制完成时调用"></a>__clone()，当对象复制完成时调用</h2><p>对象复制可以通过 clone 关键字来完成（如果可能，这将调用对象的 <strong>clone() 方法）。对象中的 </strong>clone() 方法不能被直接调用。</p>
<p>注意：</p>
<p>当对象被复制后，PHP 5 会对对象的所有属性执行一个浅复制（shallow copy）。所有的引用属性 仍然会是一个指向原来的变量的引用。</p>
<p>当复制完成时，如果定义了 <strong>clone() 方法，则新创建的对象（复制生成的对象）中的 </strong>clone() 方法会被调用，可用于修改属性的值（如果有必要的话）。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php"><span class="class"><span class="keyword">class</span> <span class="title">Person</span></span></span></span><br><span class="line"><span class="php">&#123;</span></span><br><span class="line"><span class="php">  <span class="keyword">public</span> $sex;</span></span><br><span class="line"><span class="php">  <span class="keyword">public</span> $name;</span></span><br><span class="line"><span class="php">  <span class="keyword">public</span> $age;</span></span><br><span class="line"><span class="php"> </span></span><br><span class="line"><span class="php">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($name=<span class="string">""</span>, $age=<span class="number">25</span>, $sex=<span class="string">'男'</span>)</span></span></span></span><br><span class="line"><span class="php">  &#123;</span></span><br><span class="line"><span class="php">    <span class="keyword">$this</span>-&gt;name = $name;</span></span><br><span class="line"><span class="php">    <span class="keyword">$this</span>-&gt;age = $age;</span></span><br><span class="line"><span class="php">    <span class="keyword">$this</span>-&gt;sex = $sex;</span></span><br><span class="line"><span class="php">  &#125;</span></span><br><span class="line"><span class="php"> </span></span><br><span class="line"><span class="php">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__clone</span><span class="params">()</span></span></span></span><br><span class="line"><span class="php">  &#123;</span></span><br><span class="line"><span class="php">    <span class="keyword">echo</span> <span class="keyword">__METHOD__</span>.<span class="string">"你正在克隆对象&lt;br&gt;"</span>;</span></span><br><span class="line"><span class="php">  &#125;</span></span><br><span class="line"><span class="php"> </span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"> </span></span><br><span class="line"><span class="php">$person = <span class="keyword">new</span> Person(<span class="string">'小明'</span>); <span class="comment">// 初始赋值</span></span></span><br><span class="line"><span class="php">$person2 = <span class="keyword">clone</span> $person;</span></span><br><span class="line"><span class="php"> </span></span><br><span class="line"><span class="php">var_dump(<span class="string">'persion1:'</span>);</span></span><br><span class="line"><span class="php">var_dump($person);</span></span><br><span class="line"><span class="php"><span class="keyword">echo</span> <span class="string">'&lt;br&gt;'</span>;</span></span><br><span class="line"><span class="php">var_dump(<span class="string">'persion2:'</span>);</span></span><br><span class="line"><span class="php">var_dump($person2);</span></span><br></pre></td></tr></table></figure>
<p>看结果：</p>
<p>Person::__clone你正在克隆对象</p>
<p>string(9) “persion1:” object(Person)#1 (3) { [“sex”]=&gt; string(3) “男” [“name”]=&gt; string(6) “小明” [“age”]=&gt; int(25) } </p>
<p>string(9) “persion2:” object(Person)#2 (3) { [“sex”]=&gt; string(3) “男” [“name”]=&gt; string(6) “小明” [“age”]=&gt; int(25) }</p>
<p>克隆成功。</p>
<h2 id="autoload-，尝试加载未定义的类"><a href="#autoload-，尝试加载未定义的类" class="headerlink" title="__autoload()，尝试加载未定义的类"></a>__autoload()，尝试加载未定义的类</h2><p>这里没有代码</p>
<p>PHP有很多成熟的框架，例如：ThinkPHP、Laravel、Yii、Ci等， 但底层都是MVC， 那么MVC是如何运行的？</p>
<p>MVC的运行，离不开PSR_0, PSR_4以及autoload(类的自动加载), 感兴趣的同学可以google或者其他的方式去了解的</p>
<h2 id="debugInfo-，打印所需调试信息"><a href="#debugInfo-，打印所需调试信息" class="headerlink" title="__debugInfo()，打印所需调试信息"></a>__debugInfo()，打印所需调试信息</h2><p>该方法在PHP 5.6.0及其以上版本才可以用，如果你发现使用无效或者报错，请查看啊你的版本</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php"><span class="class"><span class="keyword">class</span> <span class="title">C</span> </span>&#123;</span></span><br><span class="line"><span class="php">  <span class="keyword">private</span> $prop;</span></span><br><span class="line"><span class="php"> </span></span><br><span class="line"><span class="php">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($val)</span> </span>&#123;</span></span><br><span class="line"><span class="php">    <span class="keyword">$this</span>-&gt;prop = $val;</span></span><br><span class="line"><span class="php">  &#125;</span></span><br><span class="line"><span class="php"> </span></span><br><span class="line">  /**</span><br><span class="line">   * @return array</span><br><span class="line"><span class="php">   */</span></span><br><span class="line"><span class="php">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__debugInfo</span><span class="params">()</span> </span>&#123;</span></span><br><span class="line"><span class="php">    <span class="keyword">return</span> [</span></span><br><span class="line"><span class="php">      <span class="string">'propSquared'</span> =&gt; <span class="keyword">$this</span>-&gt;prop ** <span class="number">2</span>,</span></span><br><span class="line"><span class="php">    ];</span></span><br><span class="line"><span class="php">  &#125;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"> </span></span><br><span class="line"><span class="php">var_dump(<span class="keyword">new</span> C(<span class="number">42</span>));</span></span><br></pre></td></tr></table></figure>
<p>结果：</p>
<p>object(C)#1 (1) { [“propSquared”]=&gt; int(1764) }</p>
</div><div class="tags"><a href="/tags/PHP/">PHP</a></div><div class="post-nav"><a class="pre" href="/2017/08/07/单例设计模式/">单例设计模式</a><a class="next" href="/2017/07/28/Linux常用命令/">Linux常用命令</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form class="search-form" action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank"><input type="text" name="q" maxlength="20" placeholder="Search"/><input type="hidden" name="sitesearch" value="http://yuehuaxw.com"/></form></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/MySQL/" style="font-size: 15px;">MySQL</a> <a href="/tags/PHP/" style="font-size: 15px;">PHP</a> <a href="/tags/Git/" style="font-size: 15px;">Git</a> <a href="/tags/Hexo/" style="font-size: 15px;">Hexo</a> <a href="/tags/Linux/" style="font-size: 15px;">Linux</a> <a href="/tags/Docker/" style="font-size: 15px;">Docker</a> <a href="/tags/设计模式/" style="font-size: 15px;">设计模式</a> <a href="/tags/Nginx/" style="font-size: 15px;">Nginx</a> <a href="/tags/Redis/" style="font-size: 15px;">Redis</a> <a href="/tags/PHP框架/" style="font-size: 15px;">PHP框架</a> <a href="/tags/高并发/" style="font-size: 15px;">高并发</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="https://chensenlin.cn/" title="你好我是森林!" target="_blank">你好我是森林!</a><ul></ul><a href="https://www.eckes.site/" title="左手bug，右手情歌" target="_blank">左手bug，右手情歌</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2020 <a href="/." rel="nofollow">Hello  广华</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/3.3.5/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/3.3.5/jquery.fancybox.min.css"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>